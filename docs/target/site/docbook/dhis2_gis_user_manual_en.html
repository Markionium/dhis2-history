<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>DHIS 2 GIS User Manual</title><link xmlns="" href="css/xhtml.css" rel="stylesheet" type="text/css" /><meta content="DocBook XSL Stylesheets V1.75.2" name="generator" /><meta name="keywords" content="DHIS, GIS, Mapping" /></head><body><div class="article" title="DHIS 2 GIS User Manual"><div class="titlepage"><div><div><h2 class="title"><a xmlns:saxon="http://icl.com/saxon" id="N10001" />DHIS 2 GIS User Manual</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Jan Henrik</span> <span class="surname">Øverland</span></h3></div></div><div><div class="author"><h3 class="author"><span class="surname">Pickering</span></h3></div></div><div><div class="revhistory"><table summary="Revision history" width="100%" border="1"><tr><th colspan="3" valign="top" align="left"><b>Revision History</b></th></tr><tr><td align="left">Revision 1</td><td align="left">12/09/2009</td><td align="left">JPP</td></tr><tr><td colspan="3" align="left">
          <p>Initial conversion of document to DocBook format</p>
        </td></tr></table></div></div></div><hr /></div><div class="sect1" title="Conversion of geographical data to GeoJSON format"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="N1002A" />Conversion of geographical data to GeoJSON format</h2></div></div></div><p>The DHIS2 mapping client relies on GeoJSON files in order to display
    a map in the browser window. Often times, geographical data is received in
    many different formats, but the ESRI shape file format is one of the most
    common. Several procedures will be described below. It is important, but
    not required, that the names in your geographical data match those in the
    DHIS2 organizational hierarchy. If they do not, you will need to manually
    match them in a later step</p><div class="sect2" title="Production of GeoJSON files with Geoserver"><div class="titlepage"><div><div><h3 class="title"><a xmlns:saxon="http://icl.com/saxon" id="N1002F" />Production of GeoJSON files with Geoserver</h3></div></div></div><p>Geoserver is capable of outputting GeoJSON formats. If you have
      geoserver running someplace, you can execute the following query.</p><p><a class="ulink" href="http://localhost:8080/geoserver/wfs?request=GetFeature&amp;typename=who:zm_adm1&amp;outputformat=json" target="_top">http://localhost:8080/geoserver/wfs?request=GetFeature&amp;typename=who:zm_adm1&amp;outputformat=json</a></p><p>You will need to adjust the host destination if the machine is not
      your local machine as well as defining the actual layer in Geoserver
      which should be output to GeoJSON (in this case
      <em class="parameter"><code>who:zm_adm1</code></em>).</p><p>Upon execution of the URL, Geoserver will produce a GeoJSON file,
      and you will be asked to save it. Once it has finished downloading,
      rename the file following the suggested naming convention:</p><p>ISO2CountryCode followed by an underscore, followed by the layer
      type (e.g. “admin” for administrative layers, “health” for health
      administrative boundaries). For instance, the first administrative layer
      for Zambia would be named as "zm_admin1".</p></div><div class="sect2" title="Production of GeoJSON files with GDAL"><div class="titlepage"><div><div><h3 class="title"><a xmlns:saxon="http://icl.com/saxon" id="N10042" />Production of GeoJSON files with GDAL</h3></div></div></div><p>GDAL is a multi-platform toolkit for the manipulation of
      geographical data. It is freely available for a wide-range of platforms
      at <a class="ulink" href="???" target="_top">http://gdal.org</a></p><p>Production of GeoJSON files are straightforward with GDAL. Just
      execute (on Windows)</p><pre class="programlisting">ogr2ogr.exe -f "GeoJSON" dst_datasource_name src_datasource_name</pre><p>or on Linux</p><pre class="programlisting">ogr2ogr -f "GeoJSON"dst_datasource_name src_datasource_name</pre><p>Replace <em class="parameter"><code>dst_datasource_name</code></em> with the path
      to the destination geographical data file (following the naming
      convention described above) and
      <em class="parameter"><code>src_datasource_name</code></em> with the source geographical
      data file.</p></div><div class="sect2" title="Copying files to the DHIS application"><div class="titlepage"><div><div><h3 class="title"><a xmlns:saxon="http://icl.com/saxon" id="N1005E" />Copying files to the DHIS application</h3></div></div></div><p>Currently, your GeoJSON files should be placed in the
      DHIS_HOME/geoson of your DHIS application to be accessible to the GIS
      module. If the GeoJSON directory does not exist, you will need to create
      it manually and copy your GeoJSON files there.</p></div></div><div class="sect1" title="Administrator panel"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="N10063" />Administrator panel</h2></div></div></div><div class="screenshot"><div><img src="images/admin_panel.png" /></div></div><div class="variablelist"><dl><dt><span class="term">Map source</span></dt><dd><p><span class="guimenuitem">GeoJSON</span>: you will find your own
            registered maps in the Map combo box in the Thematic map panel.
            The Admin panels check box will become visible.</p><p><span class="guimenu">DHIS Database:</span> the Map combo box will
            simply be populated by the existing organisation unit levels and
            GeoJSON files will be created by the application automatically
            Organisation units must have coordinates stored in the database in
            order to be displayed in the map. This function is mainly intended
            for the facility level as it is easy to maintain and thus will
            offer up-to-date shapefiles.</p></dd><dt><span class="term"><span class="guibutton">Admin panel</span></span></dt><dd><p>Show/hide the shapefile management panels.</p></dd></dl></div></div><div class="sect1" title="Registering geographical information"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="N10082" />Registering geographical information</h2></div></div></div><p>In order to view data in the GIS module, you must import your
    geographical data into your DHIS installation. Once you have produced
    GeoJSON files according to the procedure above, and imported them into the
    system, you will need to establish a correspondence between the
    information in the DHIS database, and the GeoJSON file.</p><div class="screenshot"><div class="mediaobject"><img src="images/register_geodata.png" /></div></div><div class="variablelist"><dl><dt><span class="term">Organisation unit level</span></dt><dd xmlns=""><p>The level of the organization units displayed in the GeoJSON
          file.</p></dd><dt><span class="term">Map source file</span></dt><dd xmlns=""><p>The GeoJSON file name. These files must be placed in the
          mapping/geojson folder. Use e.g. Geoserver 2.0 (currently RC1) to
          easily produce GeoJSON from your shapefiles.</p></dd><dt><span class="term">Display name</span></dt><dd xmlns=""><p>Represents your map in the Map combo box in the Thematic map
          panel.</p></dd><dt><span class="term">Name column</span></dt><dd xmlns=""><p>The shapefile data column (case sensitive!) that will be
          matched against DHIS organisation unit names. If you have an
          instance of Geoserver installed, you can view the layer through the
          built-in OpenLayers client. Click on a particular area, and the
          possible fields will be displayed.</p><div class="screenshot"><div class="mediaobject"><img src="images/get_name_geoserver.png" /></div></div><div class="screenshot"><div class="mediaobject"><img src="images/get_name_geojson.png" /></div></div></dd><dt><span class="term">Longitude / latitude</span></dt><dd xmlns=""><p>The longitude and latitude refer to the approximate point
          where the map will be centered after rendering. If you have
          Geoserver running, you can view the layer through the integrated
          OpenLayers client and determine a good center point for your map.
          You can also use the background map of the DHIS GIS module, and
          determine an approximate location. You may need to experiment a bit
          with the center point and zoom level in order to get it
          correct.</p><div class="screenshot"><div class="mediaobject"><img src="images/geoserver_center_point.png" /></div></div><div class="screenshot"><div class="mediaobject"><img src="images/dhis_gis_center_point.png" /></div></div></dd><dt><span class="term">Zoom</span></dt><dd xmlns=""><p>The zoom level controls the extent of the map. Some
          experimentation will be required to get the correct zoom level.
          Start with a value of "7" and increase or decrease the zoom level
          depending on the extent of the map that should be displayed.</p></dd></dl></div></div><div class="sect1" title="Assign organization units to map"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="N100CF" />Assign organization units to map</h2></div></div></div><p>Select a registered map and wait for it to load. The organisation
    units (OU) in your database on this level will appear in the list and
    colors will appear in the map. What we want to do here is creating
    relations between OUs in the database and the corresponding OUs in the
    shapefile. This is often necessary because of inconsistencies in the
    naming in the geographical data, and what is present in the DHIS database.
    First, try auto-assign at the bottom toolbar to let the application link
    the OUs with a matching OU name in the shapefile. The polygons that remain
    white, you will have to link manually by first selecting a white OU in the
    list and then click the corresponding OU in the map.</p><div class="screenshot"><div class="mediaobject"><table cellpadding="0" cellspacing="0" summary="manufactured viewport for HTML img" border="0" width="NaN"><tr><td><img src="images/assign_org_units.png" /></td></tr></table></div></div><p>The remove button at the button tool bar removes the selected OU’s
    link. The remove all button removes all OU links for the selected
    map.</p></div><div class="sect1" title="Register overlays"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="N100E2" />Register overlays</h2></div></div></div><p>Overlays are geographical layers that do not have any direct linkage
    to data in the database. Example include roads, rivers, airports, ports,
    and other geographical information that you may want to display on your
    map, but that is not neccsarily linked ot data contained in the DHIS
    database. The <span class="guimenu">Register Overlay</span> panel will allow you to
    add new layers and determine how they will be represented visually on the
    map. </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="guilabel">Display name:</span> Represents your overlay in
        the layer tree in the upper right corner.</p></li><li class="listitem"><p><span class="guilabel">Map source file: </span>The GeoJSON file
        name.</p></li><li class="listitem"><p><span class="guilabel">Fill color: </span>Decides the fill color if the
        layer is a polygon layer. </p></li><li class="listitem"><p><span class="guilabel">Fill opacity: </span>Select an opacity level
        between 0 (invisible) and 1 (solid).</p></li><li class="listitem"><p><span class="guilabel">Stroke color: </span>The stroke color over lines
        and polygon borders.</p></li><li class="listitem"><p><span class="guilabel">Stroke width: </span>Select a stroke width between
        0 and 4.</p></li></ul></div></div><div class="sect1" title="Thematic map"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="N10110" />Thematic map</h2></div></div></div><p>This panel should be rather self-explanatory . Calculation method
    alludes to the legend interval size and set to <span class="guimenuitem">Equal
    intervals</span> they will be “highest map value – lowest map value
    / number of classes”. Choose <span class="guimenuitem">Fixed bounds </span>and
    you may set your own legend limits, e.g. “20,40,60” using a comma to
    seperate each of the class break values. </p></div><div class="sect1" title="Register views"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="N1011D" />Register views</h2></div></div></div><p>This panel will save the current thematic map view in order to
    restore it whenever you want via the <span class="guimenuitem">Map view
    </span>combo box in the <span class="guimenu">Thematic map</span> panel. By
    adding your views to DHIS 2 Dashboard you may access them there by
    inserting <span class="guimenuitem">Map views</span> into one of link
    areas.</p></div><div class="sect1" title="Register legend sets"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a xmlns:saxon="http://icl.com/saxon" id="N1012E" />Register legend sets</h2></div></div></div><p>A legend set may be connected to many indicators, but an indicator
    may only have one legend set. Thus, you may select many indicators when
    you create a legend set. When an indicator that has a legend set is
    selected in the <span class="guimenu">Thematic map</span> panel, the number of
    classes, low color and high color is automatically set.</p></div></div></body></html>