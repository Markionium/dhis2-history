
<h3>$i18n.getString( "define_validation_associations" ) </h3>

<form>
<table>
<input type='hidden' id='programId' name='programId'>
<tr>
  <th colspan="3">$i18n.getString('criteria')</th>
</tr>
<tr>
  <td><label>$i18n.getString('available_criteria')</label></td>
  <td>&nbsp;</td>
  <td><label>$i18n.getString('selected_criteria')</label></td>
</tr>
<tr>
	<td>
		<select multiple id='avalableCriteriaIds' name='avalableCriteriaIds' size="5" style="width:30em " ondblclick="moveSelectedById('avalableCriteriaIds', 'criteriaIds');">
			#foreach($c in $criteria)
			<option value='$c.id'>$c.name</option>
			#end
		</select>
	</td>
	<td width="42" align='center'>
		<input type="button" value="&gt;" onclick="moveSelectedById('avalableCriteriaIds', 'criteriaIds');" style="width:42px">
		<input type="button" value="&lt;" onclick="moveSelectedById('criteriaIds', 'avalableCriteriaIds');" style="width:42px"><br>
		<input type="button" value="&gt;&gt;" onclick="moveAllById('avalableCriteriaIds', 'criteriaIds');" style="width:42px"><br>
		<input type="button" value="&lt;&lt;" onclick="moveAllById('criteriaIds', 'avalableCriteriaIds');" style="width:42px">
	</td>
	<td>
		<select multiple id='criteriaIds' name='criteriaIds' size="5" style="width:30em " ondblClick="moveSelectedById('criteriaIds', 'avalableCriteriaIds');">
			#foreach($c in $program.patientValidationCriteria)
			<option value='$c.id'>$c.name</option>
			#end
		</select>
	</td>
</tr>

<tr>
    <td><input type="button" onClick="assignCriteria();" value="$i18n.getString('save')" style="width:10em"></td>
	<td></td>
	<td></td>
</tr>
<tr>
  <td colspan="3">&nbsp;</td>
</tr>
<tr>
  <th colspan="3">$i18n.getString('programstage_dataelement_validation')</th>
</tr>
<tr>
  <td><label>$i18n.getString('description')<em title="$i18n.getString( "required" )" class="required">*</em></label></td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>
<tr>
  <td colspan="3"><input type="text" id="description" name="description" style="width:100% "></td> 
</tr>
<tr>
  <th><label>$i18n.getString('left_side')</label></th>
  <th><label>$i18n.getString('operator')</label></th>
  <th><label>$i18n.getString('right_side')</label></th>
</tr>
<tr>
  <td><select id="leftProgramStageId" name="leftProgramStageId" style="width:30em " onchange="getDataElementsFromStage(this.value, 'leftDataElementId');">
		<option value="" selected="selected">[$i18n.getString( "please_select" )]</option>
		#foreach($stage in $stages)
		<option value="$stage.id">$stage.name</option> 
		#end
  	</select>
  </td>
  <td>&nbsp;</td>
  <td><select id="rightProgramStageId" name="rightProgramStageId" style="width:30em " onchange="getDataElementsFromStage(this.value, 'rightDataElementId');">
		<option value="" selected="selected">[$i18n.getString( "please_select" )]</option>
		#foreach($stage in $stages)
		<option value="$stage.id">$stage.name</option> 
		#end
  	</select>
  </td>
</tr>
<tr>
  <td><select id="leftDataElementId" name="leftDataElementId" style="width:30em "></select></td>
  <td align='center'><select id='operator' name='operator' style='width: 4.5em'>
          <option value='-1'>$i18n.getString('operator_less_then')</option>
          <option value='0'>$i18n.getString('operator_equal_to')</option>
          <option value='1'>$i18n.getString('operator_greater_then')</option>
    </select></td>
  <td><select id="rightDataElementId" name="rightDataElementId" style="width:30em "></select></td>
</tr>
<tr>
  <td><input type="button" onClick="validateProgramStageDEValidation();" value="$i18n.getString('save')" style="width:10em"></td>
  <td>&nbsp;</td>
  <td></td>
</tr>
</table>

<table class="listTable">
	<thead>
    <tr>
      <th>$i18n.getString('description')</th>
      <th>$i18n.getString('validation')</th>
      <th style="width:5em ">$i18n.getString('operator')</th>
    </tr>
	</thead>	
	<tbody id="list">
	#foreach($validation in $validations)
    <tr id="tr${validation.id}">
      <td>$validation.description</td>
      <td>[$validation.leftProgramStageDataElement.programStage.name.$validation.leftProgramStageDataElement.dataElement.name] 
		#if($validation.operator == '-1') <
		#elseif($criteria.operator == '0') =
		#else >
		#end
	  [$validation.rightProgramStageDataElement.programStage.name.$validation.rightProgramStageDataElement.dataElement.name]</td>
      <td>                  
	  	<a href="javascript:removeProgramStageDEValidation( '$validation.id', '$encoder.jsEncode( $validation.description )' )" title="$i18n.getString( "remove" )"><img src="../images/delete.png" alt="$i18n.getString( "remove" )"></a>
	  </td>
    </tr>
	#end
	</tbody>
</table>	

<span id='message'></span>

<script>

	byId('description').value = '';
	byId('leftProgramStageId').selectedIndex = 0;
	byId('rightProgramStageId').selectedIndex = 0;

	var i18n_confirm_delete = '$encoder.jsEscape( $i18n.getString( "confirm_delete_patient" ) , "'" )';
	var i18n_fill_fields_in_programstage_dataelement_validation = '$encoder.jsEscape( $i18n.getString( "fill_fields_in_programstage_dataelement_validation" ) , "'" )';
	
</script>
