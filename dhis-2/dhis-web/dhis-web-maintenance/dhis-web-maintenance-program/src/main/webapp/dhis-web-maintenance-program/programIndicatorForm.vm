<table>
	<tr>
		<th>$i18n.getString( "expression_items" )</th>
	</tr>	
	<tr>
		<td>
	
		<div id="expression-tabs" style="width:670px; margin: 1px 0;">
			<ul>
				<li><a href="#expression-tab1">$i18n.getString("data_elements")</a></li>
				#if($program.type!='3')
					<li><a href="#expression-tab2">$i18n.getString("attributes")</a></li>
					<li><a href="#expression-tab3">$i18n.getString("variables")</a></li>
				#end
				<li><a href="#expression-tab4">$i18n.getString("constants")</a></li>
			</ul>	
			
			<div id="expression-tab1">
			  <table style="width:100%">
		        <tr>
					<td>
						<input type='text' id='expression-de-search' onKeyUp="filterExpressionSelect(event, this.value, 'expression-data-elements');" placeholder="$i18n.getString('filter')" />
						<input type='button' value='$i18n.getString("clear")' onClick="setFieldValue('expression-de-search', '');" />			
					</td>
		        </tr>
		        <tr>
					<td>
						<select multiple id="expression-data-elements" name="expression-data-elements" size="7" style="width:100%" ondblclick="insertDataElement(this);"></select>
					</td>
				</tr>
		      </table>
			</div>
			
		#if($program.type!='3')
		
			<div id="expression-tab2">
				<table style="width:100%">
		        <tr>
					<td>
						<input type='text' id='expression-attr-search' onKeyUp="filterExpressionSelect(event, this.value, 'expression-attributes');" placeholder="$i18n.getString('filter')" />
						<input type='button' value='$i18n.getString("clear")' onClick="setFieldValue('expression-attr-search', '');" />			
					</td>
		        </tr>
		        <tr>
					<td>
						<select multiple id="expression-attributes" name="expression-attributes" size="7" style="width:100%" ondblclick="insertData(this,'A');">
							#foreach( $programAttribute in $program.programAttributes )
								#if( $programAttribute.attribute.valueType=='number' )
									<option value='$programAttribute.attribute.uid'>$encoder.htmlEncode($programAttribute.attribute.displayName)</option>
								#end
							#end
						</select>
					</td>
				</tr>
		      </table>
			</div>
			
			<div id="expression-tab3">
				<table style="width:100%">
				  <tr>
				    <td>
					  <input type='text' id='expression-var-search' onKeyUp="filterExpressionSelect(event, this.value, 'expression-variables');" placeholder="$i18n.getString('filter')" />
					  <input type='button' value='$i18n.getString("clear")' onClick="setFieldValue('expression-var-search', '');" />			
					</td>
		        </tr>
				<tr>
					<td>
						<select multiple id="expression-variables" name="expression-variables" size="7" style="width:100%" ondblclick="insertInfo(this, false);" >
							<option value="V{incident_date}">$i18n.getString( "incident_date" )</option>
							<option value="V{enrollment_date}">$i18n.getString( "date_of_enrollment" )</option>
							<option value="V{current_date}">$i18n.getString( "current_date" )</option>
							<option value="V{value_count}">$i18n.getString( "value_count" )</option>
							<option value="V{zero_pos_value_count}">$i18n.getString( "zero_pos_value_count" )</option>
						</select>
					</td>
				</tr>
				</table>
			</div>
			
		#end
		
			<div id="expression-tab4">
				<table style="width:100%">
		        <tr>
					<td>
						<input type='text' id='expression-const-search' onKeyUp="filterExpressionSelect(event, this.value, 'expression-constants');" placeholder="$i18n.getString('filter')" />
						<input type='button' value='$i18n.getString("clear")' onClick="setFieldValue('expression-const-search', '');" />			
					</td>
		        </tr>
		        <tr>
					<td>
						<select multiple id="expression-constants" name="expression-constants" size="7" style="width:100%" ondblclick="insertData(this,'C');">
							#foreach( $constant in $constants )
								<option value='$constant.uid'>$encoder.htmlEncode($constant.displayName)</option>
							#end
						</select>
					</td>
				</tr>
		      </table>
			</div>
			
		</div>
		
		</td>
	</tr>
	<tr>
        <th style="padding-top:15px">$i18n.getString( "expression" ) <span class="tipText">Tip: use abs(x) sin(x) cos(x) tan(x) ln(x) log(x) sqrt(x) mod(x,y) oizp(x) zing(x)</span></th>
    </tr>	
	<tr>
		<td>
			<textarea style="width:665px" id="expression" name="expression" onkeyup='getConditionDescription();' >$!encoder.htmlEncode($!programIndicator.expression)</textarea>
		</td>
	</tr>	
	<tr>
		<td style="padding-top:4px">
			<a class="greyButtonLink" href="javascript:insertOperator( '(' )" title="$i18n.getString( 'left_brackets' )">&#40;</a>
			<a class="greyButtonLink" href="javascript:insertOperator( ')' )" title="$i18n.getString( 'right_brackets' )">&#41;</a>
			<a class="greyButtonLink" href="javascript:insertOperator( '*' )" title="$i18n.getString( 'multiply' )">&#42;</a>
			<a class="greyButtonLink" href="javascript:insertOperator( '/' )" title="$i18n.getString( 'divide' )">&#47;</a>
			<a class="greyButtonLink" href="javascript:insertOperator( '+' )" title="$i18n.getString( 'plus' )">&#43;</a>
			<a class="greyButtonLink" href="javascript:insertOperator( '-' )" title="$i18n.getString( 'minus' )">&#45;</a><br><br>
		</td>
	</tr>	
	<tr>
        <th style="padding-top:4px">$i18n.getString( "expression_description" )</th>
    </tr>	
	<tr>
		<td>
			<div id='expression-description' style="padding: 5px 0 20px 0">$!encoder.htmlEncode($!description)</div>			
			<input type="hidden" id="checkExpression" name="checkExpression" title="$i18n.getString('expression_is_not_well_formed')" class="{validate:{required:true}}"  />
		</td>
	</tr>
</table>		

<script type="text/javascript">
	$('#expression-tabs').tabs();
</script>
