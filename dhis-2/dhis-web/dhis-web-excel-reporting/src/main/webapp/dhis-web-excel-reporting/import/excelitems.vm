<input type="hidden" id="excelItemGroupId" value="$!excelItemGroup.id"/>
<h2>$!encoder.htmlEncode($!excelItemGroup.name)</h2>
<table width="100%">
	<tr>
		<td>
			$i18n.getString( "filter_by_name" ): <input type="text" onkeyup="filterValues( this.value , 2)" style="width:300px"/>
		</td>
		<td align="right">	
			<input type="button" onclick="window.location.href = 'addExcelItemForm.action?excelItemGroupId=$excelItemGroup.id' " value="$i18n.getString('add')" style="width:150px"/> <br>
			<input type="button" onclick="copySelectedItemToGroup()" value="$i18n.getString('copy_selected_item_to')" style="width:150px"/><br>
			<input type="button" onclick="window.location='listAllExcelItemGroup.action'" value="$i18n.getString('cancel')" style="width:150px"/>
		</td>
	</tr>
</table>
<table width="100%" class="listTable" id="listTable">
	<thead>
		<tr>
			<th><input type="checkbox" id="checkAll" name="checkAll" onChange='selectedItemsAll();'></th>
			<th>$i18n.getString('name')</th>
			<th>$i18n.getString('sheetNo')</th>	
			<th>$i18n.getString('row')</th>
			<th>$i18n.getString('column')</th>		
			<th class="{sorter: false}">$i18n.getString('expression')</th>
			<th width="70px" class="{sorter: false}">$i18n.getString('operations')</th>		
		</tr>
	</thead>	
	<tbody id="list">	
	#foreach($excelItem in $excelItems)
		<tr id="tr${excelItem.id}">
		  	<td><input type="checkbox" excelItemID="$excelItem.id" excelItemName="$excelItem.name" id="excelItemChecked" name="excelItemChecked" value='$excelItem.id'></td>
			<td>$encoder.htmlEncode( $excelItem.name )</td>
			<td>$excelItem.sheetNo</td>
			<td>$excelItem.row</td>
			<td>$excelItem.column</td>
			<td>$excelItem.expression</td>
			<td align="center">				
				<a href="javascript:mode='update'; openUpdateExcelItem( '$excelItem.id' );" title="$i18n.getString( 'edit' )"><img src="../images/edit.png" alt="$i18n.getString( 'edit' )"></a>
				<a href="javascript:translate( 'ExcelItem', '$excelItem.id' )" title="$i18n.getString( "translation_translate" )"><img src="../images/i18n.png" alt="$i18n.getString( "translation_translate" )"></a>
				<a href="javascript:removeItem( $excelItem.id, '$excelItem.name', '$i18n.getString( 'confirm_delete' )', 'deleteExcelItem.action');" title="$i18n.getString( 'remove' )"><img src="../images/delete.png" alt="$i18n.getString( 'remove' )"></a>
			</td>
		</tr>	
	 
	#end	 
    </tbody>
</table>

<span id="message" style="top:100px;right:5px;position:fixed;width:200px;z-index:10004" onclick="hideById(this.id);"></span>
<span id="info" style="display:none;top:70px;right:5px;position:fixed;" onclick="hideById(this.id)"></span>

<div id="copyTo" style="position:fixed;display:none;width:450px;z-index:10001;background-color: white;border: medium solid silver;padding:20px;">
<div id="close" style="position:absolute;top:2px;right:2px;cursor: pointer;color:red;" onclick="hideById('copyTo'); deleteDivEffect();">[x]</div>
<table width="100%">
	<tr>
		<td><label>$i18n.getString('reports')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td>
			<select id="targetGroup" style="max-width:30em;min-width:30em;">
			</select>
		</td>
	</tr>
	<tr>
		<td><label>$i18n.getString('sheet_no')<em title="$i18n.getString( 'required' )" class="required">*</em></label></td>
		<td><input id="targetSheetNo" type="text"/></td>
	</tr>	
</table>
<p align="center">
<input type="button" value="$i18n.getString('ok')" onclick="validateCopyExcelItemsToExcelItemGroup();"/>
<input type="button" value="$i18n.getString('cancel')" onclick="hideById('copyTo'); deleteDivEffect();"/>
</p>
</div>

<script type="text/javascript">
    var i18n_copy_successful = '$encoder.jsEscape( $i18n.getString( "copy_successful" ) , "'")';
	var i18n_copy_items_duplicated = '$encoder.jsEscape( $i18n.getString( "copy_items_duplicated" ) , "'")';
	var i18n_copy_items = '$encoder.jsEscape( $i18n.getString( "copy_items" ) , "'")';
	var i18n_input_sheet_no = '$encoder.jsEscape( $i18n.getString( "input_sheet_no" ) , "'")';
	var i18n_choose_report = '$encoder.jsEscape( $i18n.getString( "choose_report" ) , "'")';
	var i18n_choose_excel_group = '$encoder.jsEscape( $i18n.getString( "choose_excel_group" ) , "'")';
	
	jQuery(document).ready(function(){		
		tableSorter( 'listTable' );	
	});
</script>